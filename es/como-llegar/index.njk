---
layout: base.njk
title: C√≥mo llegar
lang: es
permalink: /como-llegar/
alt: {"en": "/en/getting-here/", "fr": "/fr/comment-arriver/"}
---

{% set addr = (site.address | replace("¬∑"," ") | trim) %}
{% set qAddr = addr | urlencode %}
{% set pid = site.placeId %}
{% set hasCoords = site.lat and site.lng %}
{% set zoom = 16 %}

{% if hasCoords %}
  {% set qCoords = site.lat ~ "," ~ site.lng %}
{% else %}
  {% set qCoords = "" %}
{% endif %}

{# Enlace externo a Google Maps #}
{% if pid %}
  {% set mapsHref = "https://www.google.com/maps/search/?api=1&query=" ~ (hasCoords and qCoords or qAddr) ~ "&query_place_id=" ~ pid %}
{% else %}
  {% set mapsHref = "https://www.google.com/maps/search/?api=1&query=" ~ (hasCoords and qCoords or qAddr) %}
{% endif %}

<section class="section">
  <h1>{{ i18n.es.HowToGetHere }}</h1>

  <div class="gethere-grid">
    <div class="card contact-box">
      <h3>{{ i18n.es.Address }}</h3>
      <p>üìç {{ site.address }}</p>

      <div class="cta-row">
        <a class="btn" href="tel:{{ site.phone | replace(' ','') }}">üìû {{ i18n.es.Call }}</a>
        <a class="btn alt" href="mailto:{{ site.email }}">‚úâ {{ i18n.es.Write }}</a>
      </div>

      <a class="btn wide" href="{{ mapsHref }}" target="_blank" rel="noopener">
        {{ i18n.es.OpenInMaps or "Abrir en Google Maps" }}
      </a>
    </div>

    <div class="map-card">
      <div class="map-embed" style="position:relative">
        <!-- Mapa interactivo sin cookies -->
        <div id="map" aria-label="Mapa ‚Äî {{ site.address }}"></div>
      </div>
      <p class="map-note">{{ i18n.es.MapNote or "Ampl√≠a el mapa para ver accesos y aparcamiento." }}</p>
    </div>
  </div>
</section>

{# ===== Leaflet (CSS + JS) desde CDN. No instala cookies. ===== #}
<link
  rel="stylesheet"
  href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
  integrity="sha384-1j3x8m6l2HjQkTQnQm1S2qf8cYVhX8zQmA3A6wqI8M3E8kXUQH0lY8QkqYV2rJ7V"
  crossorigin=""
/>
<script
  src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
  integrity="sha384-2bQyQk5J7vB3wKq0t3QvQyH+zH1mS8Y1fR6Yb2m3m9p1rQ6Vv7v6m9iZ9z4l9p8B"
  crossorigin=""
></script>

<script>
(function(){
  // Coordenadas desde tu config; pon fallback por si faltan
  const LAT = parseFloat('{{ site.lat or "42.0738" }}');
  const LNG = parseFloat('{{ site.lng or "-1.5158" }}');
  const ZOOM = {{ zoom }};

  const el = document.getElementById('map');
  if (!el || isNaN(LAT) || isNaN(LNG)) return;

  // El contenedor ya tiene aspect-ratio y borde; ocupamos todo
  el.style.width = '100%';
  el.style.height = '100%';
  el.style.borderRadius = '12px';
  el.style.overflow = 'hidden';

  const map = L.map(el, { zoomControl: true, scrollWheelZoom: false })
               .setView([LAT, LNG], ZOOM);

  // Tiles de OpenStreetMap (sin cookies). Requieren atribuci√≥n.
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 20,
    attribution: '&copy; OpenStreetMap contributors'
  }).addTo(map);

  const marker = L.marker([LAT, LNG]).addTo(map);
  marker.bindPopup('Jalui Jopi').openPopup();

  // En pantallas peque√±as, centra un pel√≠n m√°s alto para dejar visible el popup
  if (window.innerWidth < 700) {
    map.panBy([0, 40], {animate: false});
  }
})();
</script>
